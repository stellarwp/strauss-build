#!/usr/bin/env php
<?php
$command_args = ! empty( $argv[1] ) ? $argv[1] : 'install';

call_user_func(function ($version) use ($command_args) {
    if( ! Phar::running() ) {
        if (is_file($autoload = getcwd() . '/vendor/autoload.php')) {
            require $autoload;
        } elseif (is_file($autoload = getcwd() . '/../../autoload.php')) {
            require $autoload;
        }

        if ( is_file( $autoload = __DIR__ . '/../vendor/autoload.php' ) ) {
            require( $autoload );
        } elseif ( is_file( $autoload = __DIR__ . '/../../../autoload.php' ) ) {
            require( $autoload );
        } else {
            fwrite( STDERR,
                'You must set up the project dependencies, run the following commands:' . PHP_EOL .
                'curl -s http://getcomposer.org/installer | php' . PHP_EOL .
                'php composer.phar install' . PHP_EOL
            );
            exit( 1 );
        }
    } else {
	    include __DIR__ . '/../vendor/autoload.php';
    }

    $app = new StellarWP\Strauss\Console\Application($version);
    $app->run(new \Symfony\Component\Console\Input\ArgvInput($command_args));
}, '0.1.1.2');
